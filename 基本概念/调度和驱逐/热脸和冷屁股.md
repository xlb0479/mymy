# 热脸和冷屁股

[*节点亲和性*](将Pod指派到节点.md#亲和性与反亲和性)是[Pod](../业务组件/泡德（Pod）/Pod.md)的一个属性，可以将它们*吸引（attracts）*到一组[节点](../集群架构/节点（Node）.md)上（可以是优先考虑也可以是强制要求）。*冷屁股（Taints）* 正相反——它可以让节点排斥某些Pod。

*热脸（Tolerations）* 是定义在Pod上的，允许（但不是要求）Pod可以调度到有匹配的冷屁股的节点上。

热脸和冷屁股协同工作，保证Pod不会被调度到不合适的节点上。一个节点可以设置多个冷屁股；如果Pod没有能贴到这个冷屁股的热脸，那就不会被调度到这个节点上。

## 概念

用[kubectl taint](https://v1-18.docs.kubernetes.io/docs/reference/generated/kubectl/kubectl-commands#taint)为节点设置冷屁股。比如：

```shell script
kubectl taint nodes node1 key=value:NoSchedule
```

给节点`node1`加了一个冷屁股。这个冷屁股有一个key`key`，值`value`，冷屁股产生的效果是`NoSchedule`。这就是说不会有Pod调度到`node1`上，除非它有匹配的热脸。

要想删除上面的冷屁股，运行：

```shell script
kubectl taint nodes node1 key:NoSchedule-
```

你在Pod的PodSpec中定义一个热脸。下面的两个热脸都能“贴到”上面`kubectl taint`创建的冷屁股上，只要拥有其中一个热脸就能调度到`node1`：

```yaml
tolerations:
- key: "key"
  operator: "Equal"
  value: "value"
  effect: "NoSchedule"
```

```yaml
tolerations:
- key: "key"
  operator: "Exists"
  effect: "NoSchedule"
```