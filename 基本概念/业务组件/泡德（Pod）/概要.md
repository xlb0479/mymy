# 概要

本文对`Pod`进行简要介绍，它不光名字简单，在k8s中，可部署的最小对象单元，就是Pod，它是宇宙中的一颗星球、是尘埃、是晶体、是夸克，是你、是我、是众生。

- [理解Pod](#理解Pod)（看完不理解别怪我）
- [与Pod同行](#与Pod同行)
- [Pod模板](#Pod模板)
- [接下来……](#接下来)

## 理解Pod

*Pod*是k8s应用的最小执行单元——可以创建或部署，最小也是最简单的k8s对象。一个Pod也就是[集群]()上的若干个具体进程。

Pod这个对象，它封装了什么呢？它封装了应用的一个容器（有的时候是多个），封装了提供存储功能的资源，封装了唯一的网络身份（IP），以及一些用来维护容器运行的选项。Pod代表了一个部署单元：*k8s一个应用下的一个实例*，可能包含了一个或若干个紧密相关又共享资源的[容器]()。

对于Pod来说，[Docker](https://www.docker.com/)是最常用的容器运行时，但也支持[其他的运行时]()。

在k8s中，Pod主要是这么两种用法：

- **只运行一个容器**。“只生一个好”，这种Pod是最常见的；这种情况下你就可以认为Pod就是一个容器的一层外衣，k8s用的是Pod，而不直接摸容器。
- **运行多个相互协作的容器**。Pod可以包含一组紧密联系、相互协作，且共享资源的容器。这些容器可以组合成一个内聚的服务——一个容器通过共享的数据卷向外部提供文件下载服务，另一个“边儿卡”（sidecar）容器负责更新这些文件。Pod把这些容器以及提供存储能力的资源都封装起来，形成一个单独的可控实体。

每个Pod都是某个应用下的一个实例。比如你想对应用水平扩展（通过多实例来提供更多的处理资源），那你就运行多个Pod，每个Pod是一个实例。在k8s中，这个事儿叫*复制（replication）*。多个Pod副本通常是作为一个整体资源，由其所属的[*控制器*](../../集群架构/控制器.md)来创建和管理的。至于这里面的门道，去看[Pod跟它的控制器](#Pod跟它的控制器)。

### Pod咋管理多个容器

Pod从一开始设计的时候就可以支持让多个相互协作的进程（容器）组合成一个内聚的服务。Pod中的容器手拉手、肩并肩，总是会被调度到同一个物理机或虚拟机上。这戏容器共享资源和依赖，互相聊天扯淡，同生同死。

虽然我这么说了，但是，你要知道，这种多容器的用法，实际上是相当高级的（吹牛逼？）。真的是只有在真的真的容器之间紧耦合的情况下你才应该这么用。比如我们在上文中提到的场景：

![pod](../img/pod.svg)

有些Pod是由[初始化容器]()跟[App容器]()组成的，在App容器运行之前，初始化容器就已经运行完成并结束了。

Pod为它的容器们提供两种可共享的资源：*网络*和*存储*。

#### 网络

每个Pod都有一个唯一的IP。Pod中的每个容器共享这个网络空间，包括IP跟端口。*Pod中*的容器可以用`localhost`跟另一个容器通信。如果容器要跟*Pod外*通信，那它们自己首先要在内部研究好怎么共享这个网络（比如端口）。

#### 存储

Pod可以定义一系列共享的[数据卷]()。Pod里面所有容器可以共享这些数据卷，共享数据。数据卷也可以把数据持久化，比如容器可能需要重启，避免数据丢失。关于这块的东西，你去看看[数据卷]()。

## 与Pod同行

### Pod跟它的控制器